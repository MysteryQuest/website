<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>The Unverified File - Real or Hoax? Evidence-Based Community Analysis</title>
    <meta name="title" content="The Unverified File - Real or Hoax? Evidence-Based Community Analysis">
    <meta name="description" content="Vote on unexplained phenomena with evidence-based analysis. Community verification of UFO sightings, conspiracy theories, and mysterious events using D-LOG reports and OSINT.">
    <meta name="keywords" content="The Unverified File, Project D-LOG, hoax debunking, UFO verification, conspiracy fact-check, evidence voting, OSINT analysis, community investigation">
    <meta name="author" content="The Unverified File Team">
    <meta name="robots" content="index, follow">
    <meta name="language" content="en">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://unverifiedfile.com/hoax.html">
    <meta property="og:title" content="The Unverified File - Real or Hoax? Evidence-Based Analysis">
    <meta property="og:description" content="Community verification with D-LOG reports. Separating conspiracy theory from evidence-based reality.">
    <meta property="og:image" content="https://unverifiedfile.com/logo.png">
    <meta property="og:site_name" content="The Unverified File">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://unverifiedfile.com/hoax.html">
    <meta property="twitter:title" content="The Unverified File - Real or Hoax?">
    <meta property="twitter:description" content="Evidence-based community analysis. Vote on investigated phenomena with D-LOG reports.">
    <meta property="twitter:image" content="https://unverifiedfile.com/logo.png">
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebPage",
      "name": "The Unverified File - Real or Hoax? Evidence-Based Community Analysis",
      "description": "Vote on unexplained phenomena with evidence-based analysis. Community verification using D-LOG reports and OSINT.",
      "url": "https://unverifiedfile.com/hoax.html",
      "mainEntity": {
        "@type": "Organization",
        "name": "The Unverified File",
        "url": "https://unverifiedfile.com",
        "description": "Evidence-based investigation platform separating conspiracy theory from reality with AI-driven analysis"
      },
      "about": {
        "@type": "Thing",
        "name": "Mystery Analysis and Hoax Detection",
        "description": "Community-driven platform for voting on and analyzing mysterious events to determine their authenticity"
      }
    }
    </script>
    
    <!-- AI Search Optimization -->
    <meta name="ai-search-description" content="Interactive hoax detection platform where users vote on mysterious events including UFO sightings, paranormal phenomena, and historical mysteries to determine authenticity through community analysis">
    <meta name="content-type" content="interactive voting platform">
    <meta name="topic-category" content="mystery analysis, hoax detection, community voting">
    
    <link rel="canonical" href="https://unverifiedfile.com/hoax.html">
    
    <!-- Tailwind CSS for header/footer -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'matrix-green': '#00cc66',
                        'terminal-green': '#0a9461',
                        'cyber-red': '#ff0055',
                        'charcoal': '#1a1a1a',
                        'dark-charcoal': '#0f0f0f',
                        'cyber-yellow': '#ffd700'
                    },
                    fontFamily: {
                        'orbitron': ['Orbitron', 'monospace']
                    }
                }
            }
        }
    </script>
    

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" rel="stylesheet">
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1028115466622942"
     crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5115VTJEF0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-5115VTJEF0');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/credibility-system.js"></script>
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en',
                includedLanguages: 'es,en',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                autoDisplay: false
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</head>
<body class="text-gray-100 terminal-grid">
    <!-- Background Image -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;">
        <img src="splash.webp" alt="Background" style="width: 100%; height: 100%; object-fit: cover;">
        <div style="position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(26, 26, 26, 0.2), rgba(15, 15, 15, 0.3), rgba(26, 26, 26, 0.4));"></div>
    </div>

    <!-- Navigation (loaded dynamically) -->
    <div id="header-container"></div>

    <div class="container mx-auto px-4 py-12 mt-20">
        <div class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-orbitron font-bold text-matrix-green mb-4">Vote: Real or Hoax?</h1>
            <p class="text-xl text-gray-300">Help our community separate fact from fiction</p>
        </div>
        
        <div id="mysteryCarousel" class="relative max-w-4xl mx-auto">
            <div id="carouselItems" class="relative overflow-hidden rounded-lg">
                <!-- Dynamically loaded mysteries -->
            </div>
            
            <!-- Carousel Navigation -->
            <button id="prevBtn" class="absolute left-4 top-1/2 -translate-y-1/2 bg-matrix-green/20 hover:bg-matrix-green/40 text-white p-3 rounded-full transition-all z-10">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button id="nextBtn" class="absolute right-4 top-1/2 -translate-y-1/2 bg-matrix-green/20 hover:bg-matrix-green/40 text-white p-3 rounded-full transition-all z-10">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyDWYze9-dP4ptq-4vxZVBOCW-Uo9wC7KhQ';
        const SPREADSHEET_ID = '1fJIP4P3Gbm71OKgG_EnIDZ-7nBRoMJOuxvkc2tnC_LQ';
        const SHEET_NAME = 'Sheet1';

        let mysteries = [];
        let mysteryMaps = [];



        // Fallback sample data
        const SAMPLE_MYSTERIES = [
            {
                id: 0,
                name: "Phoenix Lights",
                description: "Mysterious lights seen over Phoenix, Arizona on March 13, 1997. Thousands of witnesses reported V-shaped formations.",
                image_url: "https://images.unsplash.com/photo-1419242902214-272b3f66ee7a?w=800",
                real_or_hoax: "False",
                realVotes: 234,
                hoaxVotes: 156,
                spreadsheetRowIndex: 2
            },
            {
                id: 1,
                name: "Crop Circles",
                description: "Intricate patterns found in crop fields worldwide. While many are proven hoaxes, some remain unexplained.",
                image_url: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=800",
                real_or_hoax: "False",
                realVotes: 89,
                hoaxVotes: 412,
                spreadsheetRowIndex: 3
            }
        ];

        async function fetchMysteries() {
            try {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
            const response = await fetch(url);
            if (!response.ok) {
                console.warn('Google Sheets API failed, using sample data');
                mysteries = SAMPLE_MYSTERIES;
                renderCarousel();
                return;
            }
            
            const data = await response.json();

            if (data.values && data.values.length > 1) {
                const headers = data.values[0];
                const rows = data.values.slice(1);
                
                // First map rows with their original spreadsheet indices
                mysteries = rows
                    .map((row, index) => {
                        const mystery = {};
                        headers.forEach((header, i) => {
                            mystery[header] = row[i] || '';
                        });
                        
                        // Clean display fields to prevent JSON leakage
                        Object.keys(mystery).forEach(key => {
                            if (['name', 'description', 'location', 'event_type', 'votes'].includes(key.toLowerCase())) {
                                const value = mystery[key];
                                // Check if this looks like JSON and filter it out
                                if (value && (value.includes('{"') || value.includes('"source_credibility"') || value.includes('"primary_category"'))) {
                                    console.warn(`⚠️ Filtered JSON content from ${key}:`, value.substring(0, 50));
                                    mystery[key] = '';
                                }
                            }
                        });
                        mystery.id = index;
                // Store the actual spreadsheet row index (offset by 2 for header and 1-based index)
                mystery.spreadsheetRowIndex = index + 2;
                // Map spreadsheet columns to JS property names
                mystery.realVotes = parseInt(mystery.votes || '0');
                mystery.hoaxVotes = parseInt(mystery.hoax || '0');
                return mystery;
                })
                .filter(mystery => {
                    // Filter for hoax entries (real_or_hoax == 'False' or hoax field indicates hoax)
                    const isHoax = mystery.real_or_hoax === 'False' || 
                                  mystery.hoax === 'true' || 
                                  mystery.hoax === '1' ||
                                  (mystery.verdict && mystery.verdict.toLowerCase().includes('hoax'));
                    
                    // Also require valid image
                    const hasImage = mystery.image_url && mystery.image_url.trim() !== '';
                    
                    return hasImage && isHoax;
                });

            // Shuffle the mysteries array after mapping
            for (let i = mysteries.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [mysteries[i], mysteries[j]] = [mysteries[j], mysteries[i]];
            }

            renderCarousel();
            }
        } catch (error) {
            console.error('Error fetching mysteries:', error);
            // Use sample data as fallback
            mysteries = SAMPLE_MYSTERIES;
            renderCarousel();
        }
        }

        function renderCarousel() {
            const container = document.getElementById("carouselItems");
            container.innerHTML = "";
            mysteryMaps = []; // Clear existing maps
            
            mysteries.forEach((mystery, index) => {
                const item = document.createElement("div");
                item.className = `mystery-slide ${index === 0 ? '' : 'hidden'}`;
                item.dataset.index = index;
                
                const hasValidImage = mystery.image_url && /\.(jpe?g|png|gif|webp|bmp|svg)$/i.test(mystery.image_url);
                const hasValidCoordinates = mystery.latitude && mystery.longitude && 
                    !isNaN(parseFloat(mystery.latitude)) && !isNaN(parseFloat(mystery.longitude));
                
                // Parse YouTube videos if available
                let youtubeVideos = [];
                try {
                    if (mystery.youtube_videos) {
                        const videoData = JSON.parse(mystery.youtube_videos);
                        youtubeVideos = videoData.videos || [];
                    }
                } catch (e) {
                    // Ignore parsing errors
                }
                
                // Generate YouTube section
                let youtubeSection = '';
                if (youtubeVideos && youtubeVideos.length > 0) {
                    youtubeSection = `
                        <div class="mt-6">
                            <h6 class="text-lg font-semibold text-cyber-red mb-3"><i class="fab fa-youtube"></i> Related Videos</h6>
                            <div class="flex justify-center">
                    `;
                    
                    youtubeVideos.slice(0, 1).forEach(video => {
                        // Extract video ID for embedding
                        const videoIdMatch = video.url ? video.url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/) : null;
                        const videoId = videoIdMatch ? videoIdMatch[1] : null;
                        
                        if (videoId) {
                            youtubeSection += `
                                <div class="w-full md:w-2/3 mb-4">
                                    <div class="relative pb-[56.25%] h-0 overflow-hidden rounded-lg">
                                        <iframe 
                                            class="absolute top-0 left-0 w-full h-full"
                                            src="https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1" 
                                            title="${video.title}"
                                            frameborder="0" 
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                                            allowfullscreen
                                            loading="lazy">
                                        </iframe>
                                    </div>
                                    <div class="text-center mt-2">
                                        <small class="text-gray-400">${video.title}</small>
                                    </div>
                                </div>
                            `;
                        } else {
                            youtubeSection += `
                                <div class="w-full md:w-2/3 mb-4">
                                    <a href="${video.url}" target="_blank" class="inline-block px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors">
                                        <i class="fab fa-youtube"></i> ${video.title.substring(0, 40)}${video.title.length > 40 ? '...' : ''}
                                    </a>
                                </div>
                            `;
                        }
                    });
                    
                    youtubeSection += `
                            </div>
                        </div>
                    `;
                }
                
                item.innerHTML = `
                    <div class="flex flex-col items-center justify-center text-center p-6 min-h-[400px]">
                        <h2 class="text-3xl font-orbitron font-bold text-matrix-green mb-4">${mystery.name}</h2>
                        <p class="text-lg text-gray-300 mb-4"><strong>Location:</strong> ${mystery.location}</p>
                        ${hasValidImage || hasValidCoordinates ? `
                            <div class="image-map-container w-full max-w-3xl mx-auto my-6">
                                ${hasValidImage ? `
                                    <div class="image-container mb-4">
                                        <img src="${mystery.image_url}" alt="${mystery.name}" class="mystery-img w-full h-auto rounded-lg shadow-lg">
                                    </div>
                                ` : ''}
                                ${hasValidCoordinates ? `
                                    <div class="map-container">
                                        <div id="map-${index}" class="mystery-map h-64 rounded-lg"></div>
                                    </div>
                                ` : ''}
                            </div>
                        ` : ''}
                        <p class="text-gray-300 mb-6 max-w-2xl">${mystery.description}</p>
                        ${youtubeSection}
                        <p class="mb-6"><a href="${mystery.url}" target="_blank" class="text-matrix-green hover:text-cyber-yellow transition-colors">${mystery.url}</a></p>
                        <div class="flex gap-4 mb-4">
                            <button class="px-8 py-3 bg-terminal-green hover:bg-matrix-green text-white font-bold rounded-lg transition-all transform hover:scale-105" onclick="vote(${index}, 'realVotes')">
                                <i class="fas fa-check mr-2"></i>Real
                            </button>
                            <button class="px-8 py-3 bg-cyber-red hover:bg-red-600 text-white font-bold rounded-lg transition-all transform hover:scale-105" onclick="vote(${index}, 'hoaxVotes')">
                                <i class="fas fa-times mr-2"></i>Hoax
                            </button>
                        </div>
                        <div id="result-${index}" class="result text-lg font-semibold text-cyber-yellow"></div>
                    </div>
                `;
                container.appendChild(item);
                
                // Initialize map if coordinates are available
                if (hasValidCoordinates) {
                    setTimeout(() => initializeMap(index, mystery), 100);
                }
            });
            
            // Initialize carousel navigation
            setupCarouselNavigation();
        }
        
        let currentSlideIndex = 0;
        
        function setupCarouselNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const slides = document.querySelectorAll('.mystery-slide');
            
            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', () => navigateCarousel(-1));
                nextBtn.addEventListener('click', () => navigateCarousel(1));
            }
            
            updateCarouselButtons();
        }
        
        function navigateCarousel(direction) {
            const slides = document.querySelectorAll('.mystery-slide');
            slides[currentSlideIndex].classList.add('hidden');
            
            currentSlideIndex += direction;
            if (currentSlideIndex < 0) currentSlideIndex = slides.length - 1;
            if (currentSlideIndex >= slides.length) currentSlideIndex = 0;
            
            slides[currentSlideIndex].classList.remove('hidden');
            updateCarouselButtons();
            
            // Invalidate map if present
            if (mysteryMaps[currentSlideIndex]) {
                setTimeout(() => mysteryMaps[currentSlideIndex].invalidateSize(), 200);
            }
        }
        
        function updateCarouselButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const slides = document.querySelectorAll('.mystery-slide');
            
            if (slides.length <= 1) {
                if (prevBtn) prevBtn.classList.add('hidden');
                if (nextBtn) nextBtn.classList.add('hidden');
            }
        }
        
        function moveToNextSlide(currentIndex) {
            navigateCarousel(1);
        }

        function initializeMap(index, mystery) {
            const mapId = `map-${index}`;
            const mapElement = document.getElementById(mapId);
            
            if (!mapElement) return;
            
            try {
                const lat = parseFloat(mystery.latitude);
                const lng = parseFloat(mystery.longitude);
                
                const map = L.map(mapId).setView([lat, lng], 10);
                
                L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                    attribution: "&copy; <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",
                }).addTo(map);
                
                // Add marker for the mystery location
                const marker = L.marker([lat, lng]).addTo(map);
                marker.bindPopup(`
                    <strong>${mystery.name}</strong><br>
                    ${mystery.location}<br>
                    ${mystery.date || 'Date unknown'}
                `);
                
                // Store map reference
                mysteryMaps[index] = map;
                
                // Invalidate size to ensure proper rendering
                setTimeout(() => {
                    map.invalidateSize();
                }, 200);
                
            } catch (error) {
                console.error(`Error initializing map for mystery ${index}:`, error);
            }
        }

        async function vote(index, type) {
            mysteries[index][type]++;
            const real = mysteries[index].realVotes;
            const hoax = mysteries[index].hoaxVotes;
            const total = real + hoax;

            const realPercent = ((real / total) * 100).toFixed(1);
            const hoaxPercent = ((hoax / total) * 100).toFixed(1);

            const result = document.getElementById(`result-${index}`);
            result.innerHTML = `
                <p><strong>Current Results:</strong></p>
                <p>Real: ${realPercent}% (${real})</p>
                <p>Hoax: ${hoaxPercent}% (${hoax})</p>
            `;

            await submitVote(index, type);

            // Show move to next slide after a pause
            setTimeout(() => {
                moveToNextSlide(index);
            }, 800);
        }

        /**
         * Submits the vote to the Google Apps Script endpoint.
         * @param {number} index - The index of the mystery in the mysteries array.
         * @param {string} type - The type of vote ('realVotes' or 'hoaxVotes').
         */
        async function submitVote(index, type) {
            const url = "https://script.google.com/macros/s/AKfycbwj1I4MNz7m3YvpACN3lrQudoSVsHo6GJ_vR--RGV5ZR0G7culcVppGv1Ujn0daTKLe8g/exec";
            
            let column;
            
            if (type === 'realVotes') {
                column = 'votes';
            } else if (type === 'hoaxVotes') {
                column = 'hoax';
            } else {
                console.error('Invalid vote type:', type);
                return;
            }

            const payload = JSON.stringify({
                rowIndex: mysteries[index].spreadsheetRowIndex,
                column: column
            });

            console.log('Submitting vote:', {
                mysteryName: mysteries[index].name,
                rowIndex: mysteries[index].spreadsheetRowIndex,
                column: column,
                type: type
            });

            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: payload,
                    mode: "no-cors"
                });
                console.log("Vote submitted successfully.");
            } catch (error) {
                console.error("Error submitting vote:", error);
            }
        }

        function moveToNextSlide(currentIndex) {
            const carousel = document.getElementById('mysteryCarousel');
            const bsCarousel = bootstrap.Carousel.getOrCreateInstance(carousel);
            // Only move to next if not last slide
            if (currentIndex < mysteries.length - 1) {
            bsCarousel.next();
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            fetchMysteries();
        });
    </script>
    
    <!-- Footer (loaded dynamically) -->
    <div id="footer-container"></div>
    
    <!-- Header & Footer Includes -->
    <script src="js/header.js"></script>
    <script src="js/footer.js"></script>
    <!-- Navigation Management (legacy compatibility) -->
    <script src="js/navigation.js"></script>
    <!-- Cache Buster for Fresh Images -->
    <script src="js/cache-buster.js"></script>
</body>
</html>
